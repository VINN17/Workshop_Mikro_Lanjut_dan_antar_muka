<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Slave SPI Communication System</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #333; overflow-x: hidden; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .slide { background: white; border-radius: 20px; padding: 40px; margin-bottom: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        h1 { color: #667eea; font-size: 2.5em; margin-bottom: 20px; border-bottom: 4px solid #667eea; padding-bottom: 10px; }
        h2 { color: #764ba2; font-size: 2em; margin: 30px 0 20px 0; }
        h3 { color: #667eea; font-size: 1.5em; margin: 20px 0 15px 0; }
        .highlight { background: linear-gradient(120deg, #ffd89b 0%, #19547b 100%); color: white; padding: 30px; border-radius: 15px; margin: 20px 0; }
        .code-block { background: #1e1e1e; color: #d4d4d4; padding: 20px; border-radius: 10px; margin: 15px 0; font-family: 'Courier New', monospace; }
        .keyword { color: #569cd6; } .string { color: #ce9178; } .comment { color: #6a9955; } .number { color: #b5cea8; }
        .flow-step { background: white; border-left: 4px solid #667eea; padding: 20px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .flow-arrow { text-align: center; color: #667eea; font-size: 2em; margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        th { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px; text-align: left; }
        td { padding: 15px; border-bottom: 1px solid #ddd; }
        .feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .feature-card { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; }
        .feature-icon { font-size: 3em; margin-bottom: 15px; }
        .metric-box { display: inline-block; background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px 25px; border-radius: 10px; margin: 10px; }
        .metric-value { font-size: 2em; display: block; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Slide 1 -->
        <div class="slide">
            <h1>üöÄ Multi-Slave SPI Communication System</h1>
            <div class="highlight">
                <h2>Sistem Komunikasi SPI Master-Slave dengan Protocol Custom</h2>
                <p style="font-size: 1.2em; margin-top: 15px;">Real-time monitoring ‚Ä¢ Fast & Non-blocking ‚Ä¢ PC Control Interface</p>
            </div>
            <div class="feature-grid">
                <div class="feature-card"><div class="feature-icon">üì°</div><h3>SPI Protocol</h3><p>Custom packet format</p></div>
                <div class="feature-card"><div class="feature-icon">‚ö°</div><h3>High Speed</h3><p>2 MHz, 100 Hz</p></div>
                <div class="feature-card"><div class="feature-icon">üíæ</div><h3>EEPROM</h3><p>Auto backup</p></div>
                <div class="feature-card"><div class="feature-icon">üñ•Ô∏è</div><h3>PC Interface</h3><p>Serial control</p></div>
            </div>
        </div>

        <!-- Slide 2 -->
        <div class="slide">
            <h1>üìê Arsitektur Sistem</h1>
            <h2>Hardware Configuration</h2>
            <table>
                <tr><th>Pin</th><th>Master</th><th>Slave</th></tr>
                <tr><td>MOSI</td><td>51</td><td>11</td></tr>
                <tr><td>MISO</td><td>50</td><td>12</td></tr>
                <tr><td>SCK</td><td>52</td><td>13</td></tr>
                <tr><td>SS1/2/3</td><td>A13/A14/A15</td><td>10</td></tr>
            </table>
            <h2>SPI Configuration</h2>
            <table>
                <tr><th>Parameter</th><th>Master</th><th>Slave</th></tr>
                <tr><td>Mode</td><td>Master</td><td>Slave</td></tr>
                <tr><td>Clock</td><td>2 MHz</td><td>Follow</td></tr>
                <tr><td>Data Mode</td><td>MODE0</td><td>MODE0</td></tr>
                <tr><td>Baud</td><td>115200</td><td>9600</td></tr>
            </table>
        </div>

        <!-- Slide 3 -->
        <div class="slide">
            <h1>üì¶ Format Paket</h1>
            <h2>Request (Master ‚Üí Slave): 5 bytes</h2>
            <div class="code-block">[0xFF] [0xFE] [ID] [CMD] [CS]
 SYNC1  SYNC2  0x01 0x01  ID^CMD</div>
            <h2>Response (Slave ‚Üí Master)</h2>
            <h3>Single Byte: 5 bytes</h3>
            <div class="code-block">[0xFF] [0xFE] [ID] [DATA] [CS]</div>
            <h3>16-bit Data: 6 bytes</h3>
            <div class="code-block">[0xFF] [0xFE] [ID] [HIGH] [LOW] [CS]</div>
        </div>

        <!-- Slide 4 -->
        <div class="slide">
            <h1>üéÆ Command Set</h1>
            <h2>SPI Commands</h2>
            <table>
                <tr><th>Command</th><th>Value</th><th>Description</th></tr>
                <tr><td>CMD_READ_VALUE</td><td>0x01</td><td>Read PB2</td></tr>
                <tr><td>CMD_READ_SENSOR</td><td>0x02</td><td>Read ADC</td></tr>
                <tr><td>CMD_READ_COUNTER</td><td>0x03</td><td>Read Counter</td></tr>
            </table>
            <h2>PC Commands (Serial)</h2>
            <table>
                <tr><th>Command</th><th>Output</th></tr>
                <tr><td>X1</td><td>>>> PB2</td></tr>
                <tr><td>X2</td><td>>>> ADC</td></tr>
                <tr><td>X3</td><td>>>> PB2 ADC</td></tr>
                <tr><td>X7</td><td>>>> PB2 ADC CNT</td></tr>
                <tr><td>STOP</td><td>[Display stopped]</td></tr>
            </table>
        </div>

        <!-- Slide 5 -->
        <div class="slide">
            <h1>üîÑ Alur Data (Step 1-6)</h1>
            <div class="flow-step">
                <h3>Step 1: PC Request</h3>
                <div class="code-block">PC: <span class="string">13</span> <span class="comment">// Slave 1, PB2+ADC</span></div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 2: Master Parse</h3>
                <div class="code-block">slaveNum = <span class="number">1</span>; dataSelect = <span class="number">3</span>;</div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 3: Master ‚Üí Slave (CMD 0x01)</h3>
                <div class="code-block">[<span class="number">0xFF</span> <span class="number">0xFE</span> <span class="number">0x01</span> <span class="number">0x01</span> <span class="number">0x00</span>]</div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 4: Slave Process</h3>
                <div class="code-block">ISR validates & prepares response</div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 5: Slave ‚Üí Master</h3>
                <div class="code-block">[<span class="number">0xFF</span> <span class="number">0xFE</span> <span class="number">0x01</span> <span class="number">0x01</span> <span class="number">0x00</span>] <span class="comment">// PB2=1</span></div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 6: Master Validate</h3>
                <div class="code-block">Read 15 bytes, find sync, validate CS</div>
            </div>
        </div>

        <!-- Slide 6 -->
        <div class="slide">
            <h1>üîÑ Alur Data (Step 7-12)</h1>
            <div class="flow-step">
                <h3>Step 7: Master ‚Üí Slave (CMD 0x02)</h3>
                <div class="code-block">[<span class="number">0xFF</span> <span class="number">0xFE</span> <span class="number">0x01</span> <span class="number">0x02</span> <span class="number">0x03</span>]</div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 8: Slave ‚Üí Master (16-bit)</h3>
                <div class="code-block">[<span class="number">0xFF</span> <span class="number">0xFE</span> <span class="number">0x01</span> <span class="number">0x03</span> <span class="number">0x40</span> <span class="number">0x42</span>] <span class="comment">// 832</span></div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 9: Master Parse 16-bit</h3>
                <div class="code-block">value = (0x03 &lt;&lt; 8) | 0x40 = <span class="number">832</span></div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 10: Save EEPROM</h3>
                <div class="code-block">EEPROM[0x00-0x03] = {1, 0x03, 0x40, cnt}</div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 11: Display PC</h3>
                <div class="code-block">Serial: <span class="string">">>> 1 832"</span></div>
            </div>
            <div class="flow-arrow">‚Üì</div>
            <div class="flow-step">
                <h3>Step 12: Loop (100 Hz)</h3>
                <div class="code-block">Repeat every 10ms until STOP</div>
            </div>
        </div>

        <!-- Slide 7 -->
        <div class="slide">
            <h1>üîç Parsing & Validation</h1>
            <h2>Master: Find Sync Pattern</h2>
            <div class="code-block"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) {
    <span class="keyword">if</span> (buf[i]==<span class="number">0xFF</span> && buf[i+<span class="number">1</span>]==<span class="number">0xFE</span> && buf[i+<span class="number">2</span>]==ID) {
        <span class="keyword">if</span> (validateChecksum()) <span class="keyword">return</span> parseData();
    }
}</div>
            <h2>Slave: State Machine</h2>
            <div class="code-block">WAIT_SYNC1 ‚Üí WAIT_SYNC2 ‚Üí WAIT_ID ‚Üí 
WAIT_CMD ‚Üí WAIT_CS ‚Üí SEND_RESPONSE</div>
        </div>

        <!-- Slide 8 -->
        <div class="slide">
            <h1>üîê Checksum</h1>
            <h2>XOR Algorithm</h2>
            <div class="code-block"><span class="comment">// Request</span>
CS = ID ^ CMD = <span class="number">0x01</span> ^ <span class="number">0x02</span> = <span class="number">0x03</span>

<span class="comment">// Response (single)</span>
CS = ID ^ DATA = <span class="number">0x01</span> ^ <span class="number">0x01</span> = <span class="number">0x00</span>

<span class="comment">// Response (16-bit)</span>
CS = ID ^ HIGH ^ LOW = <span class="number">0x01</span> ^ <span class="number">0x03</span> ^ <span class="number">0x40</span> = <span class="number">0x42</span></div>
        </div>

        <!-- Slide 9 -->
        <div class="slide">
            <h1>‚ö° Timing & Performance</h1>
            <div style="text-align: center;">
                <div class="metric-box"><span class="metric-value">2 MHz</span>SPI Clock</div>
                <div class="metric-box"><span class="metric-value">100 Hz</span>Update Rate</div>
                <div class="metric-box"><span class="metric-value">~2 ms</span>Latency</div>
            </div>
            <h2>Communication Timeline</h2>
            <table>
                <tr><th>Time (ms)</th><th>Event</th></tr>
                <tr><td>0.000</td><td>PC sends command</td></tr>
                <tr><td>0.002</td><td>Master activates SS</td></tr>
                <tr><td>0.007</td><td>Request sent</td></tr>
                <tr><td>0.015</td><td>Slave responds</td></tr>
                <tr><td>0.020</td><td>SS deactiviv</td></tr>
                <tr><td>0.022</td><td>Parse & validate</td></tr>
                <tr><td>0.025</td><td>Display to PC</td></tr>
            </table>
        </div>

        <!-- Slide 10 -->
        <div class="slide">
            <h1>üíæ EEPROM Storage</h1>
            <h2>Memory Map</h2>
            <table>
                <tr><th>Address</th><th>Slave</th><th>Data</th></tr>
                <tr><td>0x00-0x03</td><td>Slave 1</td><td>PB2,ADC_H,ADC_L,CNT</td></tr>
                <tr><td>0x04-0x07</td><td>Slave 2</td><td>PB2,ADC_H,ADC_L,CNT</td></tr>
                <tr><td>0x08-0x0B</td><td>Slave 3</td><td>PB2,ADC_H,ADC_L,CNT</td></tr>
            </table>
            <h2>Save/Load</h2>
            <div class="code-block"><span class="comment">// Save</span>
EEPROM.update(base+<span class="number">0</span>, pb2);
EEPROM.update(base+<span class="number">1</span>, adc&gt;&gt;<span class="number">8</span>);
EEPROM.update(base+<span class="number">2</span>, adc&<span class="number">0xFF</span>);
EEPROM.update(base+<span class="number">3</span>, cnt);

<span class="comment">// Load</span>
pb2 = EEPROM.read(base+<span class="number">0</span>);
adc = (EEPROM.read(base+<span class="number">1</span>)&lt;&lt;<span class="number">8</span>) | EEPROM.read(base+<span class="number">2</span>);</div>
        </div>

        <!-- Slide 11 -->
        <div class="slide">
            <h1>üñ•Ô∏è LCD Display</h1>
            <h2>16x2 LCD Format</h2>
            <div class="code-block">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇS1 P:1 A:832    ‚îÇ
‚îÇ   C:5 OK       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
            <h2>Update Code</h2>
            <div class="code-block">lcd.clear();
lcd.setCursor(<span class="number">0</span>,<span class="number">0</span>);
lcd.print(<span class="string">"S1 P:"</span> + pb2 + <span class="string">" A:"</span> + adc);
lcd.setCursor(<span class="number">0</span>,<span class="number">1</span>);
lcd.print(<span class="string">"   C:"</span> + cnt + (valid ? <span class="string">" OK"</span> : <span class="string">" ER"</span>));</div>
            <p>Rotates every 500ms: S1 ‚Üí S2 ‚Üí S3 ‚Üí S1</p>
        </div>

        <!-- Slide 12 -->
        <div class="slide">
            <h1>üõ°Ô∏è Error Handling</h1>
            <h2>Error Detection</h2>
            <table>
                <tr><th>Error</th><th>Detection</th><th>Action</th></tr>
                <tr><td>Checksum fail</td><td>XOR mismatch</td><td>Return 0xFF/0xFFFF</td></tr>
                <tr><td>No sync</td><td>Pattern not found</td><td>Return error</td></tr>
                <tr><td>Wrong ID</td><td>ID mismatch</td><td>Ignore, reset state</td></tr>
                <tr><td>No response</td><td>Timeout</td><td>Mark invalid</td></tr>
            </table>
            <h2>Master Error Handling</h2>
            <div class="code-block"><span class="keyword">if</span> (pb2 == <span class="number">0xFF</span> || adc == <span class="number">0xFFFF</span>) {
    data.valid = <span class="keyword">false</span>;
    <span class="keyword">return</span> <span class="keyword">false</span>;
}
data.valid = <span class="keyword">true</span>;
saveToEEPROM();</div>
        </div>

        <!-- Slide 13 -->
        <div class="slide">
            <h1>üåü Keunggulan Sistem</h1>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">üöÄ</div>
                    <h3>Performance</h3>
                    <ul style="text-align:left;">
                        <li>2 MHz SPI</li>
                        <li>100 Hz rate</li>
                        <li>Non-blocking</li>
                        <li>~2ms latency</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>Reliable</h3>
                    <ul style="text-align:left;">
                        <li>Checksum</li>
                        <li>Sync pattern</li>
                        <li>Error recovery</li>
                        <li>State machine</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíæ</div>
                    <h3>Persistent</h3>
                    <ul style="text-align:left;">
                        <li>Auto EEPROM</li>
                        <li>Fast response</li>
                        <li>No data loss</li>
                        <li>100k cycles</li>
                    </ul>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üì°</div>
                    <h3>Scalable</h3>
                    <ul style="text-align:left;">
                        <li>3 slaves</li>
                        <li>Easy expand</li>
                        <li>Custom CMD</li>
                        <li>Flexible</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 14 -->
        <div class="slide">
            <h1>üìå Summary</h1>
            <div class="highlight">
                <h2>Multi-Slave SPI Communication System</h2>
                <p style="font-size: 1.1em; line-height: 1.8;">
                    Sistem komunikasi SPI yang menghubungkan <strong>1 Master</strong> dengan <strong>3 Slave</strong> 
                    menggunakan <strong>custom protocol</strong> dengan sync pattern dan checksum validation.
                    Master dapat berkomunikasi dengan PC via Serial untuk <strong>real-time monitoring</strong> 
                    dengan kecepatan hingga <strong>100 updates/detik</strong>.
                </p>
            </div>
            <h2>Data Flow</h2>
            <div class="code-block">PC ‚Üí Master ‚Üí Slave ‚Üí EEPROM ‚Üí Display

1. PC: "17" (Slave 1, All data)
2. Master polls via SPI (3 commands)
3. Slave responds with validated data
4. Master saves to EEPROM
5. Display: ">>> 1 832 5"
6. Repeat @ 100 Hz until "STOP"</div>
            <div style="text-align: center; margin: 30px 0;">
                <div class="metric-box"><span class="metric-value">2 MHz</span>SPI Speed</div>
                <div class="metric-box"><span class="metric-value">100 Hz</span>Display Rate</div>
                <div class="metric-box"><span class="metric-value">~2 ms</span>Latency</div>
                <div class="metric-box"><span class="metric-value">3 Slaves</span>Scalable</div>
            </div>
        </div>

        <!-- Footer -->
        <div class="slide" style="text-align: center; padding: 60px;">
            <h1 style="font-size: 3em; margin-bottom: 20px;">Thank You! üöÄ</h1>
            <p style="font-size: 1.5em; color: #667eea;">Multi-Slave SPI Communication System</p>
            <p style="font-size: 1.2em; margin-top: 20px; color: #764ba2;">Questions & Discussion</p>
        </div>
    </div>
</body>
</html>
